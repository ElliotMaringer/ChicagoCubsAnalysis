"0","cubs_halves_plot <- cubs_splits_halves %>%"
"0","  mutate("
"0","    HR_per_game = HR / G,"
"0","    Runs_per_game = R / G,"
"0","    Split = factor(Split, levels = c(""1st Half"", ""2nd Half""))"
"0","  ) %>%"
"0","  select(Split, BA, OPS, HR_per_game, Runs_per_game) %>%"
"0","  pivot_longer(-Split, names_to = ""Metric"", values_to = ""Value"")"
"0",""
"0","percent_changes <- cubs_halves_plot %>%"
"0","  pivot_wider(names_from = Split, values_from = Value) %>%"
"0","  mutate("
"0","    pct_change = (`2nd Half` - `1st Half`) / `1st Half` * 100,"
"0","    max_value = pmax(`1st Half`, `2nd Half`)"
"0","  )"
"0",""
"0","ggplot(cubs_halves_plot, aes(x = Metric, y = Value, fill = Split)) +"
"0","  geom_bar(stat = ""identity"", position = position_dodge(width = 0.7), width = 0.6) +"
"0","  geom_text("
"0","    data = percent_changes,"
"0","    aes("
"0","      x = Metric,"
"0","      y = max_value + 0.02,"
"0","      label = paste0(round(pct_change, 1), ""%""),"
"0","    ),"
"0","    inherit.aes = FALSE,"
"0","    vjust = 0,"
"0","    size = 4,"
"0","    color = ""red"""
"0","  ) +"
"0","  labs("
"0","    title = ""Cubs Batting Metrics: Pre vs Post All-Star Break"","
"0","    x = ""Metric"","
"0","    y = ""Value"","
"0","    fill = ""Season Half"""
"0","  ) +"
"0","  scale_fill_manual(values = c(""1st Half"" = ""#0072B2"", ""2nd Half"" = ""#D55E00"")) +"
"0","  theme_minimal()"
