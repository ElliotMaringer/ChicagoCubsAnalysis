size = 4,
color = "red"
) +
labs(
title = "Seiya Suzuki – Pre vs Post All-Star Metrics",
x = "Metric",
y = "Value",
fill = "Season Half"
) +
scale_fill_manual(values = c("1st Half" = "#0072B2", "2nd Half" = "#D55E00")) +
theme_minimal()
View(suzuki_months)
suzuki_months <- suzuki_months %>%
filter(!is.na(Month))
suzuki_months <- suzuki_months %>%
filter(!is.na(Split))
suzuki_months <- suzuki_months %>%
mutate(
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
ggplot(suzuki_months, aes(x = Month, y = SLG, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "Seiya Suzuki – Monthly Slugging Percentage (SLG)",
y = "SLG",
x = "Month"
) +
theme_minimal()
suzuki_months <- suzuki_months %>%
filter(!is.na(Month))
suzuki_months <- suzuki_months %>%
mutate(
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
ggplot(suzuki_months, aes(x = Month, y = SLG, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "Seiya Suzuki – Monthly Slugging Percentage (SLG)",
y = "SLG",
x = "Month"
) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(scales)
cubs_splits_halves <- read.csv("data/CubsHalvesTeamSplits.csv")
cubs_splits_months <- read.csv("data/CubsMonthsTeamSplits.csv")
cubs_batting_totals <- read.csv("data/CubsTeamBatting.csv")
cubs_box_score <- read.csv("data/CubsSeasonBoxScore.csv")
pca_halves <- read.csv("data/Crow-ArmstrongHalvesBatting.csv")
pca_months <- read.csv("data/Crow-ArmstrongMonthsBatting.csv")
suzuki_halves <- read.csv("data/SuzukiHalvesBatting.csv")
suzuki_months <- read.csv("data/SuzukiMonthsBatting.csv")
tucker_halves <- read.csv("data/TuckerHalvesBatting.csv")
tucker_months <- read.csv("data/TuckerMonthsBatting.csv")
cubs_box_score <- cubs_box_score %>%
mutate(
WL_Clean = gsub("-wo", "", `W.L`),
Result = case_when(
WL_Clean == "W" ~ 1,
WL_Clean == "L" ~ -1,
TRUE ~ 0
),
GamesAbove500 = cumsum(Result)
)
ggplot(cubs_box_score, aes(x = `Gm.`, y = GamesAbove500)) +
geom_line(color = "blue", size = 1.2) +
geom_smooth(method = "loess", se = FALSE, color = "orange", size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 96, linetype = "dotted", color = "red", linewidth = 1) +
annotate("text", x = 96, y = max(cubs_box_score$GamesAbove500, na.rm = TRUE),
label = "All-Star Break", vjust = -0.5, hjust = -0.1, color = "red", size = 3.5) +
labs(
title = "Chicago Cubs Games Above .500 (2025)",
x = "Game Number",
y = "Games Above .500"
) +
theme_minimal()
cubs_halves_plot <- cubs_splits_halves %>%
mutate(
HR_per_game = HR / G,
Runs_per_game = R / G,
Split = factor(Split, levels = c("1st Half", "2nd Half"))
) %>%
select(Split, BA, OPS, HR_per_game, Runs_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
percent_changes <- cubs_halves_plot %>%
pivot_wider(names_from = Split, values_from = Value) %>%
mutate(
pct_change = (`2nd Half` - `1st Half`) / `1st Half` * 100,
max_value = pmax(`1st Half`, `2nd Half`)
)
ggplot(cubs_halves_plot, aes(x = Metric, y = Value, fill = Split)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_text(
data = percent_changes,
aes(
x = Metric,
y = max_value + 0.02,
label = paste0(round(pct_change, 1), "%"),
),
inherit.aes = FALSE,
vjust = 0,
size = 4,
color = "red"
) +
labs(
title = "Cubs Batting Metrics: Pre vs Post All-Star Break",
x = "Metric",
y = "Value",
fill = "Season Half"
) +
scale_fill_manual(values = c("1st Half" = "#0072B2", "2nd Half" = "#D55E00")) +
theme_minimal()
# Create metrics
cubs_splits_months <- cubs_splits_months %>%
mutate(
HR_per_game = HR / G,
Runs_per_game = R / G,
Split = factor(Split, levels = c("April/March", "May", "June", "July", "August"))  # Make sure "Split" is correctly ordered
)
# Reshape data for plotting
month_plot <- cubs_splits_months %>%
select(Split, BA, OPS, HR_per_game, Runs_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
# Create plot
ggplot(month_plot, aes(x = Split, y = Value, color = Metric, group = Metric)) +
geom_line(size = 1.2) +
geom_point(size = 2) +
geom_vline(xintercept = 4.2, linetype = "dashed", color = "red") +  # Between June & July
annotate("text", x = 4.6, y = max(month_plot$Value, na.rm = TRUE), label = "All-Star Break", color = "red", hjust = 0) +
labs(
title = "Cubs Monthly Batting Trends (2025)",
y = "Per-Game / Rate Metric",
x = ""
) +
theme_minimal()
# Compute derived metrics and format
pca_halves_plot <- pca_halves %>%
mutate(
HR_per_game = HR / G,
RBI_per_game = RBI / G,
AVG = H / AB,
OPS = OPS,  # Assuming already present
Split = factor(Split, levels = c("1st Half", "2nd Half"))
) %>%
select(Split, AVG, OPS, HR_per_game, RBI_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
# Calculate percent changes
pca_percent_changes <- pca_halves_plot %>%
pivot_wider(names_from = Split, values_from = Value) %>%
mutate(
pct_change = (`2nd Half` - `1st Half`) / `1st Half` * 100,
max_value = pmax(`1st Half`, `2nd Half`)
)
# Plot
ggplot(pca_halves_plot, aes(x = Metric, y = Value, fill = Split)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_text(
data = pca_percent_changes,
aes(
x = Metric,
y = max_value + 0.02,
label = paste0(round(pct_change, 1), "%")
),
inherit.aes = FALSE,
vjust = 0,
size = 4,
color = "red"
) +
labs(
title = "Pete Crow-Armstrong – Pre vs Post All-Star Metrics",
x = "Metric",
y = "Value",
fill = "Season Half"
) +
scale_fill_manual(values = c("1st Half" = "#0072B2", "2nd Half" = "#D55E00")) +
theme_minimal()
pca_months <- pca_months %>%
filter(!is.na(Month))
pca_months <- pca_months %>%
filter(!is.na(Split))
pca_months <- pca_months %>%
mutate(
K_per_game = SO / G,
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
ggplot(pca_months, aes(x = Month, y = K_per_game, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "PCA Strikeouts per Game by Month",
y = "Strikeouts per Game",
x = "Month"
) +
theme_minimal()
pca_months <- pca_months %>%
mutate(
K_per_game = SO / G,
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
pca_months <- pca_months %>%
filter(!is.na(Month))
ggplot(pca_months, aes(x = Month, y = K_per_game, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "PCA Strikeouts per Game by Month",
y = "Strikeouts per Game",
x = "Month"
) +
theme_minimal()
suzuki_months <- suzuki_months %>%
mutate(
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
suzuki_months <- suzuki_months %>%
filter(!is.na(Month))
ggplot(suzuki_months, aes(x = Month, y = SLG, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "Seiya Suzuki – Monthly Slugging Percentage (SLG)",
y = "SLG",
x = "Month"
) +
theme_minimal()
tucker_months <- tucker_months %>%
mutate(
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
tucker_months <- tucker_months %>%
filter(!is.na(Month))
ggplot(tucker_months, aes(x = Month, y = OBP, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "Kyle Tucker – Monthly On-Base Percentage (OBP)",
y = "OBP",
x = "Month"
) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(scales)
cubs_splits_halves <- read.csv("data/CubsHalvesTeamSplits.csv")
cubs_splits_months <- read.csv("data/CubsMonthsTeamSplits.csv")
cubs_batting_totals <- read.csv("data/CubsTeamBatting.csv")
cubs_box_score <- read.csv("data/CubsSeasonBoxScore.csv")
pca_halves <- read.csv("data/Crow-ArmstrongHalvesBatting.csv")
pca_months <- read.csv("data/Crow-ArmstrongMonthsBatting.csv")
suzuki_halves <- read.csv("data/SuzukiHalvesBatting.csv")
suzuki_months <- read.csv("data/SuzukiMonthsBatting.csv")
tucker_halves <- read.csv("data/TuckerHalvesBatting.csv")
tucker_months <- read.csv("data/TuckerMonthsBatting.csv")
cubs_box_score <- cubs_box_score %>%
mutate(
WL_Clean = gsub("-wo", "", `W.L`),
Result = case_when(
WL_Clean == "W" ~ 1,
WL_Clean == "L" ~ -1,
TRUE ~ 0
),
GamesAbove500 = cumsum(Result)
)
ggplot(cubs_box_score, aes(x = `Gm.`, y = GamesAbove500)) +
geom_line(color = "blue", size = 1.2) +
geom_smooth(method = "loess", se = FALSE, color = "orange", size = 1) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 96, linetype = "dotted", color = "red", linewidth = 1) +
annotate("text", x = 96, y = max(cubs_box_score$GamesAbove500, na.rm = TRUE),
label = "All-Star Break", vjust = -0.5, hjust = -0.1, color = "red", size = 3.5) +
labs(
title = "Chicago Cubs Games Above .500 (2025)",
x = "Game Number",
y = "Games Above .500"
) +
theme_minimal()
cubs_halves_plot <- cubs_splits_halves %>%
mutate(
HR_per_game = HR / G,
Runs_per_game = R / G,
Split = factor(Split, levels = c("1st Half", "2nd Half"))
) %>%
select(Split, BA, OPS, HR_per_game, Runs_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
percent_changes <- cubs_halves_plot %>%
pivot_wider(names_from = Split, values_from = Value) %>%
mutate(
pct_change = (`2nd Half` - `1st Half`) / `1st Half` * 100,
max_value = pmax(`1st Half`, `2nd Half`)
)
ggplot(cubs_halves_plot, aes(x = Metric, y = Value, fill = Split)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_text(
data = percent_changes,
aes(
x = Metric,
y = max_value + 0.02,
label = paste0(round(pct_change, 1), "%"),
),
inherit.aes = FALSE,
vjust = 0,
size = 4,
color = "red"
) +
labs(
title = "Cubs Batting Metrics: Pre vs Post All-Star Break",
x = "Metric",
y = "Value",
fill = "Season Half"
) +
scale_fill_manual(values = c("1st Half" = "#0072B2", "2nd Half" = "#D55E00")) +
theme_minimal()
# Create metrics
cubs_splits_months <- cubs_splits_months %>%
mutate(
HR_per_game = HR / G,
Runs_per_game = R / G,
Split = factor(Split, levels = c("April/March", "May", "June", "July", "August"))  # Make sure "Split" is correctly ordered
)
# Reshape data for plotting
month_plot <- cubs_splits_months %>%
select(Split, BA, OPS, HR_per_game, Runs_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
# Create plot
ggplot(month_plot, aes(x = Split, y = Value, color = Metric, group = Metric)) +
geom_line(size = 1.2) +
geom_point(size = 2) +
geom_vline(xintercept = 4.2, linetype = "dashed", color = "red") +  # Between June & July
annotate("text", x = 4.6, y = max(month_plot$Value, na.rm = TRUE), label = "All-Star Break", color = "red", hjust = 0) +
labs(
title = "Cubs Monthly Batting Trends (2025)",
y = "Per-Game / Rate Metric",
x = ""
) +
theme_minimal()
# Compute derived metrics and format
pca_halves_plot <- pca_halves %>%
mutate(
HR_per_game = HR / G,
RBI_per_game = RBI / G,
AVG = H / AB,
OPS = OPS,  # Assuming already present
Split = factor(Split, levels = c("1st Half", "2nd Half"))
) %>%
select(Split, AVG, OPS, HR_per_game, RBI_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
# Calculate percent changes
pca_percent_changes <- pca_halves_plot %>%
pivot_wider(names_from = Split, values_from = Value) %>%
mutate(
pct_change = (`2nd Half` - `1st Half`) / `1st Half` * 100,
max_value = pmax(`1st Half`, `2nd Half`)
)
# Plot
ggplot(pca_halves_plot, aes(x = Metric, y = Value, fill = Split)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_text(
data = pca_percent_changes,
aes(
x = Metric,
y = max_value + 0.02,
label = paste0(round(pct_change, 1), "%")
),
inherit.aes = FALSE,
vjust = 0,
size = 4,
color = "red"
) +
labs(
title = "Pete Crow-Armstrong – Pre vs Post All-Star Metrics",
x = "Metric",
y = "Value",
fill = "Season Half"
) +
scale_fill_manual(values = c("1st Half" = "#0072B2", "2nd Half" = "#D55E00")) +
theme_minimal()
pca_months <- pca_months %>%
mutate(
K_per_game = SO / G,
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
pca_months <- pca_months %>%
filter(!is.na(Month))
ggplot(pca_months, aes(x = Month, y = K_per_game, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "PCA Strikeouts per Game by Month",
y = "Strikeouts per Game",
x = "Month"
) +
theme_minimal()
# Compute derived metrics and format
tucker_halves_plot <- tucker_halves %>%
mutate(
HR_per_game = HR / G,
RBI_per_game = RBI / G,
AVG = H / AB,
OPS = OPS,  # Assuming already present
Split = factor(Split, levels = c("1st Half", "2nd Half"))
) %>%
select(Split, AVG, OPS, HR_per_game, RBI_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
# Calculate percent changes
tucker_percent_changes <- tucker_halves_plot %>%
pivot_wider(names_from = Split, values_from = Value) %>%
mutate(
pct_change = (`2nd Half` - `1st Half`) / `1st Half` * 100,
max_value = pmax(`1st Half`, `2nd Half`)
)
# Plot
ggplot(tucker_halves_plot, aes(x = Metric, y = Value, fill = Split)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_text(
data = tucker_percent_changes,
aes(
x = Metric,
y = max_value + 0.02,
label = paste0(round(pct_change, 1), "%")
),
inherit.aes = FALSE,
vjust = 0,
size = 4,
color = "red"
) +
labs(
title = "Kyle Tucker – Pre vs Post All-Star Metrics",
x = "Metric",
y = "Value",
fill = "Season Half"
) +
scale_fill_manual(values = c("1st Half" = "#0072B2", "2nd Half" = "#D55E00")) +
theme_minimal()
tucker_months <- tucker_months %>%
mutate(
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
tucker_months <- tucker_months %>%
filter(!is.na(Month))
ggplot(tucker_months, aes(x = Month, y = OBP, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "Kyle Tucker – Monthly On-Base Percentage (OBP)",
y = "OBP",
x = "Month"
) +
theme_minimal()
# Compute derived metrics and format
suzuki_halves_plot <- suzuki_halves %>%
mutate(
HR_per_game = HR / G,
RBI_per_game = RBI / G,
AVG = H / AB,
OPS = OPS,  # Assuming already present
Split = factor(Split, levels = c("1st Half", "2nd Half"))
) %>%
select(Split, AVG, OPS, HR_per_game, RBI_per_game) %>%
pivot_longer(-Split, names_to = "Metric", values_to = "Value")
# Calculate percent changes
suzuki_percent_changes <- suzuki_halves_plot %>%
pivot_wider(names_from = Split, values_from = Value) %>%
mutate(
pct_change = (`2nd Half` - `1st Half`) / `1st Half` * 100,
max_value = pmax(`1st Half`, `2nd Half`)
)
# Plot
ggplot(suzuki_halves_plot, aes(x = Metric, y = Value, fill = Split)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
geom_text(
data = suzuki_percent_changes,
aes(
x = Metric,
y = max_value + 0.02,
label = paste0(round(pct_change, 1), "%")
),
inherit.aes = FALSE,
vjust = 0,
size = 4,
color = "red"
) +
labs(
title = "Seiya Suzuki – Pre vs Post All-Star Metrics",
x = "Metric",
y = "Value",
fill = "Season Half"
) +
scale_fill_manual(values = c("1st Half" = "#0072B2", "2nd Half" = "#D55E00")) +
theme_minimal()
suzuki_months <- suzuki_months %>%
mutate(
Month = factor(Split, levels = c("March/April", "May", "June", "July", "August"))
)
suzuki_months <- suzuki_months %>%
filter(!is.na(Month))
ggplot(suzuki_months, aes(x = Month, y = SLG, group = 1)) +
geom_line(color = "blue", size = 1.2) +
geom_point(size = 3, color = "blue") +
labs(
title = "Seiya Suzuki – Monthly Slugging Percentage (SLG)",
y = "SLG",
x = "Month"
) +
theme_minimal()
